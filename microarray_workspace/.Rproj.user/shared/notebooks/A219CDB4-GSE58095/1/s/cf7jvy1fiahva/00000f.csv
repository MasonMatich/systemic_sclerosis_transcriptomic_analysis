"0","# Calculate sample correlations"
"0","sample_cor <- cor(exprs_data, method = ""pearson"")"
"0",""
"0","# Create annotation for heatmap"
"0","annotation_col <- data.frame("
"0","  Group = metadata$Group,"
"0","  Sex = metadata$Gender_Male"
"0",")"
"0","rownames(annotation_col) <- colnames(exprs_data)"
"0",""
"0","# Define colors"
"0","ann_colors <- list("
"0","  Group = c(SSc = ""#E74C3C"", Control = ""#3498DB""),"
"0","  Sex = c(""Male"" = ""#F36E12"", ""Female"" = ""#F39C12"")"
"0",")"
"0",""
"0","# Plot heatmap"
"0","pheatmap(sample_cor,"
"0","         annotation_col = annotation_col,"
"0","         annotation_colors = ann_colors,"
"0","         show_rownames = FALSE,"
"0","         show_colnames = FALSE,"
"0","         main = ""Sample-to-Sample Correlation Heatmap"","
"0","         color = colorRampPalette(c(""blue"", ""white"", ""red""))(100))"
